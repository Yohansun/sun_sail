<div class="row-fluid">
  <div class="span2 bs-docs-sidebar">
    <ul class="nav nav-list bs-docs-sidenav affix span2">
      <li class="active"><a href="#"><i class="icon-chevron-right"></i>默认仓库</a></li>
    </ul>
  </div>

  <div class="span10">
    <ul class="nav nav-tabs">
      <li><%= link_to "库存查询", stocks_path %></li>
      <li class="active"><%= link_to "入库单", stock_in_bills_path %></li>
      <li><%= link_to "出库单", stock_out_bills_path %></li>
      <li><%= link_to "所有进销", stock_bills_path %></li>
    </ul><!-- nav-tabs -->
    <div class="tab-content">
      <div class="tab-pane active" id="stock_check">
        <%= form_tag stock_in_bills_path,:method => "get",:class => "well well-small form-horizontal font12"  do %>
        <%= render :partial => "search" %>
        <% end %>
      </div>
      
      <div class="pull-left">
        <span class="label label-info">共有<%= @count %>条数据</span>
      </div>
      <div class="pull-right">
        <%= link_to "导出","#",:onclick => "processChecked('#{stock_in_bills_path(:search => params[:search],:format => :xls,:on => '?')}')",:class => "btn btn-small btn-info"%>
      </div></br>
        
        <%= form_tag "/",:method => "post",:id => "stock_in_bills_form", :remote => true do %>
        <div class="btn-toolbar">
          <div class="btn-group">
            <button class="btn btn-warning">操作</button>
            <button class="btn btn-warning dropdown-toggle" data-toggle="dropdown">
              <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li>
                <%= link_to "新建", new_stock_in_bill_path %>
              </li>
              <li>
                <%= link_to "查看","javascript:if($('input:checked').length < 1){
                alert('请选择一个入库单');
                }else{
                  var bill_id = $(\"input[name='bill_ids[]']:checked:first\").val();
                  $(location).attr('href','/stock_in_bills/'+bill_id);
                }"  %>
              </li>
                <li>
                  <%= link_to "审核", "#",:onclick => "processRequest(this)",:goto => "/stock_in_bills/check",:request_method => "post",:mesg => "确认审核吗?"  %>
                  </li>
                  <%- if current_account.settings.enable_module_third_party_stock == 1 %>
                  <li>
                    <%= link_to "同步", "#",:onclick => "processRequest(this)",:goto => "/stock_in_bills/sync",:request_method => "post",:mesg => "确认同步吗?"  %>
                      </li>
                      <li>
                        <%= link_to "撤销", "#",:onclick => "processRequest(this)",:goto => "/stock_in_bills/rollback",:request_method => "post",:mesg => "确认撤销吗?"  %>
                          </li>
                          <%- end %>
                        </ul>
                      </div><!-- btn-group -->
                    </div>
                    <%= render "table" %>
                    <%- end %>
                    <%= paginate @bills %>
                  </div><!--span10 -->
                </div><!-- tab-content -->
              </div><!-- span10 -->
</div><!--row-fluid -->

<script>
function processChecked(full_url){
  var bill_ids = $('input[name=\"bill_ids[]\"]:checked').map(function(){ return $(this).val()}).get().join(',');
  $(location).attr('href', full_url + '&export_ids=' + bill_ids);
}
</script>
